<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Firebase App SDK -->
  <script>
    if ('serviceWorker' in navigator) {
     navigator.serviceWorker.register('/omniGenX/firebase-messaging-sw.js')
       .then(reg => console.log('Service Worker registered!', reg))
       .catch(err => console.error('Service Worker registration failed:', err));
    }
  </script>
<script type="module">
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js';
  import { getMessaging, getToken, onMessage, onBackgroundMessage  } from 'https://www.gstatic.com/firebasejs/9.6.1/firebase-messaging.js';

  // Initialize Firebase with your configuration
    const firebaseConfig = {
        apiKey: "AIzaSyDqaigSMPYeXYu1__T8Mj_y0h3bCQYb4I0",
        authDomain: "livechat-dc6d0.firebaseapp.com",
        projectId: "livechat-dc6d0",
        storageBucket: "livechat-dc6d0.firebasestorage.app",
        messagingSenderId: "302939024833",
        appId: "1:302939024833:web:a0e9e00a1c3d93b6509340",
        measurementId: "G-FX8JBRT2N5"
      };

  
  // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const messaging = getMessaging(app);

    // Request permission to show notifications
    async function requestPermission() {
      try {
        const permission = await Notification.requestPermission();
        if (permission === 'granted') {
          console.log("Notification permission granted.");
          // Get the FCM token
          const token = await getToken(messaging, { vapidKey: "BCwqdeCW7-s0fR_xrLVl-MK5ymSwqfyqF_vy_7GcnlrUr25mTNn8ZVHjNQ77jJdW0lI9_ArPzYMaRe10UwrBY0A" });
          console.log("FCM Token:", token);
        } else {
          console.error("Notification permission denied.");
        }
      } catch (error) {
        console.error("Permission request failed:", error);
      }
    }

    // Call the function to request notification permission
    requestPermission();

    // Background message handler
    onBackgroundMessage(messaging, (payload) => {
      console.log('Received background message:', payload);
      const notificationTitle = payload.notification.title;
      const notificationOptions = {
        body: payload.notification.body,
        icon: '/firebase-logo.png', // Adjust icon path
      };

      self.registration.showNotification(notificationTitle, notificationOptions);
    });
</script>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: url('https://mir-s3-cdn-cf.behance.net/project_modules/source/563b91136818669.6200dffce2880.jpg') no-repeat center center;
      background-size: cover; /* Ensures the background image covers the full width and height */
      color: white;
      min-height: 100vh;
      overflow: hidden; /* Prevents scrolling in case of slight overflow */
    }

    #lightningout {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh; /* Full height for the component container */
    }
  </style>
</head>
<body>
  <div id="lightningout"></div>
  <script src="https://texvellc--texvedemo.sandbox.my.salesforce.com/lightning/lightning.out.js"></script>
  <script>
    $Lightning.use(
      'c:LightningOutDependencyApp', // name of the Lightning Out app
      function () { // callback after the framework and app load
        $Lightning.createComponent(
          'c:websiteChat', // top-level component of the Lightning Out app
          {}, // attributes to set on the component
          'lightningout', // DOM element ID where the component is inserted
          function (cmp) { // callback after the component loads
            console.log('The component was created.');
          }
        );
      },
      'https://texvellc--texvedemo.sandbox.my.site.com' // Experience Cloud site endpoint
    );
  </script>
</body>
</html>
